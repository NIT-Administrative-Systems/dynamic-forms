import{_ as a,o as s,c as e,e as n}from"./app-FFB5UPsB.js";const t={},o=n(`<h1 id="file-uploads" tabindex="-1"><a class="header-anchor" href="#file-uploads"><span>File Uploads</span></a></h1><p>File uploads are supported via Amazon S3 or directly to local storage. By default both options are exposed to the Form builder in order to allow only one or the other set <code>VITE_STORAGE_DEFAULT_VALUE</code> to either <code>s3</code> or <code>url</code>.</p><h2 id="s3-uploads" tabindex="-1"><a class="header-anchor" href="#s3-uploads"><span>S3 Uploads</span></a></h2><p>S3 Uploads are done in a multi-step process:</p><ol><li>When a user tries to upload a file, Formiojs submits an AJAX request to <code>App\\Http\\Controllers\\DynamicFormsStorageController</code> asking for a presigned S3 upload URL.</li><li>The controller communicates with AWS to create a presigned upload URL that is only valid for a few minutes, then sends this URL to Formiojs.</li><li>Formiojs then submits an HTTP POST to the presigned S3 URL with the file data.</li></ol><p>The uploaded file is never sent through your Laravel application -- it goes directly from the browser to S3. After the upload, your application can move or download the file and process it.</p><p>Requests to download or view files follows a similar multi-step approach: when a user clicks a download link, Formiojs is asking the controller for a presigned download URL that only remains valid for a few minutes, and then the browser is sent there.</p><p>The AWS S3 bucket itself should be private. The presigned URLs are what provide security for objects: the Laravel app gets a request for a resource, performs its own authorization checks, and then tells S3 to prepare a link for an authorized user.</p><p>Local file upload does not use presigned URL but directly uploads and downloads from local storage.</p><h3 id="buckets-cors-policy" tabindex="-1"><a class="header-anchor" href="#buckets-cors-policy"><span>Buckets &amp; CORS Policy</span></a></h3><p>Since the end-user&#39;s browser is doing requests directly to your S3 bucket to upload and download files, you will need to set an appropriate CORS policy on the bucket.</p><p>The below wildcard policy will work, but you may wish to add your domain names for the <code>AllowedOrigin</code>.</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CORSConfiguration</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://s3.amazonaws.com/doc/2006-03-01/<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CORSRule</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AllowedOrigin</span><span class="token punctuation">&gt;</span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>AllowedOrigin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AllowedMethod</span><span class="token punctuation">&gt;</span></span>PUT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>AllowedMethod</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AllowedMethod</span><span class="token punctuation">&gt;</span></span>GET<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>AllowedMethod</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AllowedHeader</span><span class="token punctuation">&gt;</span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>AllowedHeader</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>CORSRule</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>CORSConfiguration</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="local-storage-uploads" tabindex="-1"><a class="header-anchor" href="#local-storage-uploads"><span>Local Storage Uploads</span></a></h2><p>Local file handling is done simply via AJAX requests to <code>App\\Http\\Controllers\\DynamicFormsStorageController</code> Files are stored at Laravel&#39;s storage_path(&#39;app/uploaded&#39;) with a keyed filename, similarly downloading and delete requests are also handled by Form.js with the keyed file</p>`,15),l=[o];function p(i,c){return s(),e("div",null,l)}const d=a(t,[["render",p],["__file","uploads.html.vue"]]),u=JSON.parse('{"path":"/uploads.html","title":"File Uploads","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"S3 Uploads","slug":"s3-uploads","link":"#s3-uploads","children":[{"level":3,"title":"Buckets & CORS Policy","slug":"buckets-cors-policy","link":"#buckets-cors-policy","children":[]}]},{"level":2,"title":"Local Storage Uploads","slug":"local-storage-uploads","link":"#local-storage-uploads","children":[]}],"git":{"updatedTime":1710857654000,"contributors":[{"name":"Nick Evans","email":"nick.evans@northwestern.edu","commits":1}]},"filePathRelative":"uploads.md","excerpt":"\\n<p>File uploads are supported via Amazon S3 or directly to local storage. By default both options are exposed to the Form builder in order to allow only one or the other set <code>VITE_STORAGE_DEFAULT_VALUE</code> to either <code>s3</code> or <code>url</code>.</p>\\n<h2>S3 Uploads</h2>\\n<p>S3 Uploads are done in a multi-step process:</p>"}');export{d as comp,u as data};
